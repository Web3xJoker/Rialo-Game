<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Rialo Protocol Puzzle</title>
  <style>
    body {
      background: #111;
      color: #e5e5e5;
      font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
      margin: 0;
      min-height: 100vh;
    }
    .puzzle-container {
      max-width: 1000px;
      margin: 0 auto;
      min-height: 100vh;
      display: flex;
      align-items: center;
      flex-direction: column;
      position: relative;
    }
    .puzzle-title {
      font-size: 2.3em;
      margin-top: 32px;
      color: #fff;
      text-align: center;
    }
    .puzzle-desc {
      color: #bbf7d0;
      text-align: center;
      margin-bottom: 18px;
    }
    .draggable-row {
      display: flex;
      justify-content: center;
      margin: 35px 0 15px 0;
      gap: 22px;
    }
    .draggable-step {
      background: #23292d;
      color: #bbf7d0;
      border-radius: 14px;
      border: 2px solid #39404a;
      width: 140px;
      min-height: 50px;
      font-size: 1em;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 500;
      margin: 6px 2px;
      cursor: grab;
      user-select: none;
    }
    .drop-zone-row {
      display: flex;
      justify-content: center;
      margin-bottom: 22px;
      position: relative;
      z-index: 2;
    }
    .step-drop {
      width: 140px;
      height: 54px;
      background: #23292d;
      border: 2px solid #39404a;
      border-radius: 12px;
      margin: 9px 11px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #bbb;
      font-size:1em;
      transition: border 0.2s;
      position:relative;
      z-index: 6;
    }
    .step-drop.filled {
      border:2px solid #bbf7d0;
      background: #222;
      color: #1ada93;
    }
    .protocol-row {
      display: flex;
      justify-content: center;
      align-items: flex-end;
      margin-top: 38px;
      gap: 70px;
      z-index: 4;
      position:relative;
    }
    .protocol-box {
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:5px;
      min-width:90px;
    }
    .protocol-box img {
      width: 70px;
      height: 70px;
      border-radius: 12px;
      background: #222;
      border: 2px solid #39404a;
      box-shadow:0 2px 8px #000b;
    }
    .protocol-label {
      color:#bbf7d0;
      font-size:1em;
      text-align:center;
      margin-top:6px;
    }
    /* SVG lines (placed absolutely behind rows) */
    .svg-lines {
      position:absolute;
      left:0;
      top:0;
      pointer-events:none;
      z-index:1;
    }
  </style>
</head>
<body>
  <div class="puzzle-container">
    <div class="puzzle-title">Level 1: Rebuild the Rialo Protocol Flow</div>
    <div class="puzzle-desc">Drag and match each protocol step to where it happens in the network. Reference below roles and the connection lines!</div>

    <!-- Draggable protocol steps up top -->
    <div class="draggable-row">
      <div class="draggable-step" draggable="true" data-step="1">Contract Minted</div>
      <div class="draggable-step" draggable="true" data-step="2">Send Contract Address</div>
      <div class="draggable-step" draggable="true" data-step="3">Task Result to Contract Addr</div>
      <div class="draggable-step" draggable="true" data-step="4">Task Result and Addr</div>
      <div class="draggable-step" draggable="true" data-step="5">Task Result to Contract Addr</div>
      <div class="draggable-step" draggable="true" data-step="6">Funds Released</div>
      <div class="draggable-step" draggable="true" data-step="7">Task Result</div>
    </div>

    <!-- Step 2 on main row, steps 1/3/4/5/6/7 below (use flex/grid for more precise layout as needed) -->
    <div style="height: 55px;"></div>
    <div class="drop-zone-row" style="justify-content:center;">
      <div class="step-drop" id="drop2" data-accept="2"></div>
    </div>

    <div class="drop-zone-row">
      <div class="step-drop" id="drop1" data-accept="1"></div>
      <div class="step-drop" id="drop3" data-accept="3"></div>
      <div class="step-drop" id="drop4" data-accept="4"></div>
      <div class="step-drop" id="drop5" data-accept="5"></div>
      <div class="step-drop" id="drop6" data-accept="6"></div>
      <div class="step-drop" id="drop7" data-accept="7"></div>
    </div>

    <!-- SVG for connection lines between boxes (adjust coords as needed!) -->
    <svg width="900" height="285" class="svg-lines">
      <!-- Example static lines; adjust x/y to fit your drop zones and protocol-boxes visually -->
      <!-- <line x1="120" y1="0" x2="120" y2="200" stroke="#bbf7d0" stroke-width="3"/> -->
      <!-- Use more lines/paths based on diagram layout -->
    </svg>

    <!-- Fixed protocol roles row at the bottom -->
    <div class="protocol-row">
      <div class="protocol-box">
        <img src="customer.png" alt="Customer"/>
        <div class="protocol-label">Customer</div>
      </div>
      <div class="protocol-box">
        <img src="agent.png" alt="Agent"/>
        <div class="protocol-label">Agent</div>
      </div>
      <div class="protocol-box">
        <img src="server.png" alt="Server"/>
        <div class="protocol-label">Server</div>
      </div>
      <div class="protocol-box">
        <img src="judge.png" alt="Judge"/>
        <div class="protocol-label">Judge</div>
      </div>
    </div>
  </div>
  <script>
    // Simple drag-n-drop pairing by data attributes
    const drags = document.querySelectorAll('.draggable-step');
    const drops = document.querySelectorAll('.step-drop');
    drags.forEach(d => {
      d.addEventListener('dragstart', e=>{
        d.classList.add('dragging');
        setTimeout(()=>{d.style.visibility="hidden";},1);
      });
      d.addEventListener('dragend', e=>{
        d.classList.remove('dragging');
        d.style.visibility="";
      });
    });
    drops.forEach(drop => {
      drop.addEventListener('dragover', e => e.preventDefault());
      drop.addEventListener('drop', e=>{
        e.preventDefault();
        const drag = document.querySelector('.draggable-step.dragging') || Array.from(drags).find(d=>d.style.visibility==="hidden");
        if (drag && drop.dataset.accept === drag.dataset.step && !drop.hasChildNodes()) {
          drop.textContent = '';
          drop.appendChild(drag);
          drop.classList.add('filled');
          drag.setAttribute('draggable','false');
        }
      });
    });
  </script>
</body>
</html>
